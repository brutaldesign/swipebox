/*! Swipebox v1.2.8 | Constantin Saguin csag.co | MIT License | github.com/brutaldesign/swipebox */
(function(n,t,i,r){i.swipebox=function(u,f){var v={useCSS:!0,initialIndexOnArray:0,hideBarsDelay:3e3,videoMaxWidth:1140,vimeoColor:"CCCCCC",beforeOpen:null,afterClose:null,changeSlide:null,elements:[]},e=this,o=[],h=u.selector,y=i(h),p=navigator.userAgent.match(/(iPad)|(iPhone)|(iPod)|(Android)|(PlayBook)|(BB10)|(BlackBerry)|(Opera Mini)|(IEMobile)|(webOS)|(MeeGo)/i),c=p!==null||t.createTouch!==r||"ontouchstart"in n||"onmsgesturechange"in n||navigator.msMaxTouchPoints,w=!!t.createElementNS&&!!t.createElementNS("http://www.w3.org/2000/svg","svg").createSVGRect,l=n.innerWidth?n.innerWidth:i(n).width(),a=n.innerHeight?n.innerHeight:i(n).height(),b='<div id="swipebox-overlay">\t\t\t\t<div id="swipebox-slider"><\/div>\t\t\t\t<div id="swipebox-caption"><\/div>\t\t\t\t<div id="swipebox-action">\t\t\t\t\t<a id="swipebox-close"><\/a>\t\t\t\t\t<a id="swipebox-prev"><\/a>\t\t\t\t\t<a id="swipebox-next"><\/a>\t\t\t\t<\/div>\t\t<\/div>',s;e.settings={};e.init=function(){if(e.settings=i.extend({},v,f),i.isArray(u))o=u,s.target=i(n),s.init(e.settings.initialIndexOnArray);else i(t).on("click",h,function(n){if(n.target.parentNode.className==="slide current")return!1;i.isArray(u)||(s.destroy(),$elem=i(h),e.settings.elements=$elem,s.actions());o=[];var f,r,t;t||(r="rel",t=i(this).attr(r));$elem=t&&t!==""&&t!=="nofollow"?y.filter("["+r+'="'+t+'"]'):i(h);$elem.each(function(){var n=null,t=null;i(this).attr("title")&&(n=i(this).attr("title"));i(this).attr("href")&&(t=i(this).attr("href"));o.push({href:t,title:n})});f=$elem.index(i(this));n.preventDefault();n.stopPropagation();s.target=i(n.target);s.init(f)})};e.refresh=function(){i.isArray(u)||(s.destroy(),$elem=i(h),s.actions())};s={init:function(n){e.settings.beforeOpen&&e.settings.beforeOpen();this.target.trigger("swipebox-start");i.swipebox.isOpen=!0;this.build();this.openSlide(n);this.openMedia(n);this.preloadMedia(n+1);this.preloadMedia(n-1)},build:function(){var n=this,t;i("body").append(b);n.doCssTrans()&&(i("#swipebox-slider").css({"-webkit-transition":"left 0.4s ease","-moz-transition":"left 0.4s ease","-o-transition":"left 0.4s ease","-khtml-transition":"left 0.4s ease",transition:"left 0.4s ease"}),i("#swipebox-overlay").css({"-webkit-transition":"opacity 1s ease","-moz-transition":"opacity 1s ease","-o-transition":"opacity 1s ease","-khtml-transition":"opacity 1s ease",transition:"opacity 1s ease"}),i("#swipebox-action, #swipebox-caption").css({"-webkit-transition":"0.5s","-moz-transition":"0.5s","-o-transition":"0.5s","-khtml-transition":"0.5s",transition:"0.5s"}));w&&(t=i("#swipebox-action #swipebox-close").css("background-image"),t=t.replace("png","svg"),i("#swipebox-action #swipebox-prev,#swipebox-action #swipebox-next,#swipebox-action #swipebox-close").css({"background-image":t}));i.each(o,function(){i("#swipebox-slider").append('<div class="slide"><\/div>')});n.setDim();n.actions();c?n.gesture():n.keyboard();n.animBars();n.resize()},setDim:function(){var t,r,u={};"onorientationchange"in n?n.addEventListener("orientationchange",function(){n.orientation===0?(t=l,r=a):(n.orientation===90||n.orientation===-90)&&(t=a,r=l)},!1):(t=n.innerWidth?n.innerWidth:i(n).width(),r=n.innerHeight?n.innerHeight:i(n).height());u={width:t,height:r};i("#swipebox-overlay").css(u)},resize:function(){var t=this;i(n).resize(function(){t.setDim()}).resize()},supportTransition:function(){for(var i="transition WebkitTransition MozTransition OTransition msTransition KhtmlTransition".split(" "),n=0;n<i.length;n++)if(t.createElement("div").style[i[n]]!==r)return i[n];return!1},doCssTrans:function(){if(e.settings.useCSS&&this.supportTransition())return!0},gesture:function(){var n=this,t=null,u=10,f={},r={},e=i("#swipebox-caption, #swipebox-action");e.addClass("visible-bars");n.setTimeout();i("body").bind("touchstart",function(n){return i(this).addClass("touching"),r=n.originalEvent.targetTouches[0],f.pageX=n.originalEvent.targetTouches[0].pageX,i(".touching").bind("touchmove",function(n){n.preventDefault();n.stopPropagation();r=n.originalEvent.targetTouches[0]}),!1}).bind("touchend",function(o){o.preventDefault();o.stopPropagation();t=r.pageX-f.pageX;t>=u?n.getPrev():t<=-u?n.getNext():e.hasClass("visible-bars")?(n.clearTimeout(),n.hideBars()):(n.showBars(),n.setTimeout());i(".touching").off("touchmove").removeClass("touching")})},setTimeout:function(){if(e.settings.hideBarsDelay>0){var t=this;t.clearTimeout();t.timeout=n.setTimeout(function(){t.hideBars()},e.settings.hideBarsDelay)}},clearTimeout:function(){n.clearTimeout(this.timeout);this.timeout=null},showBars:function(){var n=i("#swipebox-caption, #swipebox-action");this.doCssTrans()?n.addClass("visible-bars"):(i("#swipebox-caption").animate({top:0},500),i("#swipebox-action").animate({bottom:0},500),setTimeout(function(){n.addClass("visible-bars")},1e3))},hideBars:function(){if(e.settings.hideBarsDelay>0){var n=i("#swipebox-caption, #swipebox-action");this.doCssTrans()?n.removeClass("visible-bars"):(i("#swipebox-caption").animate({top:"-50px"},500),i("#swipebox-action").animate({bottom:"-50px"},500),setTimeout(function(){n.removeClass("visible-bars")},1e3))}},animBars:function(){var n=this,t=i("#swipebox-caption, #swipebox-action");t.addClass("visible-bars");n.setTimeout();i("#swipebox-slider").click(function(){t.hasClass("visible-bars")||(n.showBars(),n.setTimeout())});c||i("#swipebox-action").hover(function(){n.showBars();t.addClass("visible-bars");n.clearTimeout()},function(){e.settings.hideBarsDelay>0&&(t.removeClass("visible-bars"),n.setTimeout())})},keyboard:function(){var t=this;i(n).bind("keyup",function(n){n.preventDefault();n.stopPropagation();n.keyCode===37?t.getPrev():n.keyCode===39?t.getNext():n.keyCode===27&&t.closeSlide()})},actions:function(){var n=this,t=c?"touchend":"click";o.length<2?i("#swipebox-prev, #swipebox-next").hide():(i("#swipebox-prev").bind(t,function(t){t.preventDefault();t.stopPropagation();n.getPrev();n.setTimeout()}),i("#swipebox-next").bind(t,function(t){t.preventDefault();t.stopPropagation();n.getNext();n.setTimeout()}));i("#swipebox-close").bind(t,function(){n.closeSlide()})},setSlide:function(n,t){var r,u;t=t||!1;r=i("#swipebox-slider");this.doCssTrans()?r.css({left:-n*100+"%"}):r.animate({left:-n*100+"%"});i("#swipebox-slider .slide").removeClass("current");i("#swipebox-slider .slide").eq(n).addClass("current");this.setTitle(n);t&&r.fadeIn();i("#swipebox-prev, #swipebox-next").removeClass("disabled");u=e.settings.elements[n];e.settings.changeSlide&&e.settings.changeSlide(u);n===0?i("#swipebox-prev").addClass("disabled"):n===o.length-1&&i("#swipebox-next").addClass("disabled")},openSlide:function(t){i("html").addClass("swipebox-html");c&&i("html").addClass("swipebox-touch");i(n).trigger("resize");this.setSlide(t,!0)},preloadMedia:function(n){var t=this,i=null;o[n]!==r&&(i=o[n].href);t.isVideo(i)?t.openMedia(n):setTimeout(function(){t.openMedia(n)},1e3)},openMedia:function(n){var u=this,t=null;if(o[n]!==r&&(t=o[n].href),n<0||n>=o.length)return!1;u.isVideo(t)?i("#swipebox-slider .slide").eq(n).html(u.getVideo(t)):u.loadMedia(t,function(){i("#swipebox-slider .slide").eq(n).html(this)})},setTitle:function(n){var t=null;i("#swipebox-caption").empty();o[n]!==r&&(t=o[n].title);t&&i("#swipebox-caption").append(t)},isVideo:function(n){if(n&&(n.match(/youtube\.com\/watch\?v=([a-zA-Z0-9\-_]+)/)||n.match(/vimeo\.com\/([0-9]*)/)||n.match(/youtu\.be\/([a-zA-Z0-9\-_]+)/)))return!0},getVideo:function(n){var t="",i=n.match(/watch\?v=([a-zA-Z0-9\-_]+)/),r=n.match(/youtu\.be\/([a-zA-Z0-9\-_]+)/),u=n.match(/vimeo\.com\/([0-9]*)/);return i||r?(r&&(i=r),t='<iframe width="560" height="315" src="//www.youtube.com/embed/'+i[1]+'" frameborder="0" allowfullscreen><\/iframe>'):u&&(t='<iframe width="560" height="315"  src="//player.vimeo.com/video/'+u[1]+"?byline=0&amp;portrait=0&amp;color="+e.settings.vimeoColor+'" frameborder="0" webkitAllowFullScreen mozallowfullscreen allowFullScreen><\/iframe>'),'<div class="swipebox-video-container" style="max-width:'+e.settings.videomaxWidth+'px"><div class="swipebox-video">'+t+"<\/div><\/div>"},loadMedia:function(n,t){if(!this.isVideo(n)){var r=i("<img>").on("load",function(){t.call(r)});r.attr("src",n)}},getNext:function(){var n=this;index=i("#swipebox-slider .slide").index(i("#swipebox-slider .slide.current"));index+1<o.length?(index++,n.setSlide(index),n.preloadMedia(index+1)):(i("#swipebox-slider").addClass("rightSpring"),setTimeout(function(){i("#swipebox-slider").removeClass("rightSpring")},500))},getPrev:function(){index=i("#swipebox-slider .slide").index(i("#swipebox-slider .slide.current"));index>0?(index--,this.setSlide(index),this.preloadMedia(index-1)):(i("#swipebox-slider").addClass("leftSpring"),setTimeout(function(){i("#swipebox-slider").removeClass("leftSpring")},500))},closeSlide:function(){i("html").removeClass("swipebox-html");i("html").removeClass("swipebox-touch");i(n).trigger("resize");this.destroy()},destroy:function(){i(n).unbind("keyup");i("body").unbind("touchstart");i("body").unbind("touchmove");i("body").unbind("touchend");i("#swipebox-slider").unbind();i("#swipebox-overlay").remove();i.isArray(u)||u.removeData("_swipebox");this.target&&this.target.trigger("swipebox-destroy");i.swipebox.isOpen=!1;e.settings.afterClose&&e.settings.afterClose()}};e.init()};i.fn.swipebox=function(n){if(!i.data(this,"_swipebox")){var t=new i.swipebox(this,n);this.data("_swipebox",t)}return this.data("_swipebox")}})(window,document,jQuery)